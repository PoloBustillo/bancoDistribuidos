# ============================================
# üîß CONFIGURACI√ìN DEL SISTEMA BANCARIO
# ============================================
# Copia este archivo a .env y configura tus valores
# cp .env.example .env

# ============================================
# üóÑÔ∏è BASE DE DATOS POSTGRESQL
# ============================================
# Formato: postgresql://usuario:contrase√±a@host:puerto/nombre_bd
#
# üìå ESCENARIOS:
#
# 1Ô∏è‚É£ docker-compose.full.yml (BD en Docker):
#    DATABASE_URL=postgresql://banco_user:${DB_PASSWORD}@postgres:5432/banco
#    (No necesitas configurar esto, se genera autom√°ticamente)
#
# 2Ô∏è‚É£ docker-compose.yml (BD externa):
#    - BD en localhost del servidor:
DATABASE_URL=postgresql://banco_user:tu_password@localhost:5432/banco
#    - BD en otro servidor:
#    DATABASE_URL=postgresql://banco_user:tu_password@192.168.1.100:5432/banco
#    - BD en la nube (ej: Supabase, Railway, Neon):
#    DATABASE_URL=postgresql://banco_user:tu_password@db.ejemplo.com:5432/banco
#
# 3Ô∏è‚É£ Desarrollo local (sin Docker):
#    DATABASE_URL=postgresql://postgres:postgres@localhost:5432/banco

# ============================================
# üîê SEGURIDAD
# ============================================
# Secret para firmar JWT tokens (CAMBIAR EN PRODUCCI√ìN)
# Genera uno seguro con: openssl rand -base64 32
JWT_SECRET=tu_secreto_super_seguro_aqui_cambiar_en_produccion_usar_openssl_rand

# Password de PostgreSQL (solo para docker-compose.full.yml)
# Usado para crear la base de datos en el contenedor
DB_PASSWORD=banco_password_2024_cambiar_en_produccion

# ============================================
# üåç ENTORNO
# ============================================
# Entorno: development | production | test
NODE_ENV=production

# ============================================
# üåê CORS (Cross-Origin Resource Sharing)
# ============================================
# Dominios autorizados para conectarse al backend (separados por comas, SIN espacios)
# ‚ö†Ô∏è IMPORTANTE: No incluir slash (/) al final
#
# Ejemplos:
# - Producci√≥n: https://banco-distribuidos.vercel.app,https://tudominio.com
# - Desarrollo: http://localhost:3000,http://localhost:3001
# - Wildcard (‚ö†Ô∏è INSEGURO, solo para testing): *
CORS_ORIGIN=https://banco-distribuidos.vercel.app,https://banco.psic-danieladiaz.com

# ============================================
# üö™ PUERTOS
# ============================================
# Puerto del coordinador (gestiona locks)
COORDINADOR_PORT=4000

# Puertos de los workers (API REST)
WORKER_1_PORT=3001
WORKER_2_PORT=3002
WORKER_3_PORT=3003

# ============================================
# ÔøΩ MICROSERVICIO DE NOTIFICACIONES
# ============================================
# RabbitMQ para comunicaci√≥n as√≠ncrona
RABBITMQ_USER=user
RABBITMQ_PASS=password
RABBITMQ_URL=amqp://user:password@rabbitmq:5672
NOTIF_QUEUE=notificaciones

# Resend (servicio de emails)
# Obt√©n tu API key en: https://resend.com/api-keys
RESEND_API_KEY=tu_api_key_de_resend_aqui
RESEND_FROM="Banco <no-reply@psicologopuebla.com>"

# ============================================
# ÔøΩüîß CONFIGURACI√ìN AVANZADA (Opcional)
# ============================================

# URL del coordinador (solo para workers)
# Dentro de Docker: http://coordinador:4000
# Desarrollo local: http://localhost:4000
# COORDINADOR_URL=http://coordinador:4000

# Timeout de sesi√≥n (en milisegundos)
# Default: 1800000 (30 minutos)
# SESSION_TIMEOUT=1800000

# Modo de sesi√≥n √∫nica (true = 1 sesi√≥n por usuario, false = m√∫ltiples dispositivos)
# SINGLE_SESSION=true

# Rate limiting (requests por minuto por IP)
# RATE_LIMIT_MAX=60

# Nivel de logs (error | warn | info | debug)
# LOG_LEVEL=info

# ============================================
# üéì MODO DEMOSTRACI√ìN (Demo Mode)
# ============================================
# ‚ö†Ô∏è DEPRECADO: ENABLE_OPERATION_DELAY ya no se usa
#
# El modo demostraci√≥n ahora se controla desde el frontend mediante
# el par√°metro de consulta ?demo=true en las peticiones HTTP.
#
# Ejemplos:
# - POST /api/banco/transferir?demo=true
# - POST /api/banco/depositar?demo=true
# - POST /api/banco/retirar?demo=true
#
# Cuando est√° activado, agrega un delay aleatorio a las operaciones:
# - Transferencias: 1-4 segundos
# - Dep√≥sitos/Retiros: 0.5-2.5 segundos
#
# Esto permite visualizar mejor el funcionamiento de los locks distribuidos
# durante presentaciones educativas sin necesidad de hacer deploy.

# ============================================
# üìù NOTAS IMPORTANTES
# ============================================
#
# üîí SEGURIDAD:
# - NUNCA commitees el archivo .env al repositorio
# - Usa variables diferentes para development/production
# - Rota JWT_SECRET peri√≥dicamente
# - Usa contrase√±as fuertes (>20 caracteres, alfanum√©ricos + s√≠mbolos)
#
# üê≥ DOCKER:
# - Si usas docker-compose.full.yml, solo necesitas configurar DB_PASSWORD
# - Si usas docker-compose.yml, configura DATABASE_URL apuntando a tu BD externa
# - Si tu BD est√° en localhost y usas Docker, puede que necesites network_mode: "host"
#
# üíª DESARROLLO LOCAL:
# - Copia este archivo tambi√©n a worker/.env y coordinador/.env si usas bun run dev
# - Cada servicio puede tener su propio .env local
#
# üîó REFERENCIAS:
# - Documentaci√≥n completa: README.md
# - Troubleshooting: README.md#troubleshooting-com√∫n
# - Docker setup: DOCKER-SETUP.md
